!function(){"use strict";angular.module("pkFilters",[]).service("PKCommonService",function(){return{getPropertyValue:function(r,e){var t=e.split(".");return t.reduce(function(r,e){return r[e]},r)},convertToCamelCase:function(r){var e=r.length,t=r.substring(0,1).toLowerCase()+r.substring(1,e),n=t.split(" ");if(n.length>1)var t=n.reduce(function(r,t,n){var u=n>0?t.substring(0,1).toUpperCase()+t.substring(1,e):t;return r+u},"");return t},flattenFilters:function(r){var e=[];return r.forEach(function(r){e=e.concat(r.filters)}),e},castTrueType:function(r){var e=!isNaN(r);return e?parseFloat(r):r}}}).service("PKProductFilterService",["PKCommonService",function(r){var e=function(r,e,n){if(!e||!e.length)return n?r:[];var u=[];return r&&r.length&&r.forEach(function(r){var i=t(r,e);(n&&!i||!n&&i)&&u.push(r)}),u},t=function(r,e){for(var t=!1,u=0;u<e.length;u++){var i=e[u];if(i.expression&&i.operator&&(t="*"===i.operator?!0:"!*"===i.operator?!1:n(r,i),!t))return!1}return t},n=function(e,t){var n=t.field.split(",");if("*="===t.operator||"*>"===t.operator||"*<"===t.operator){var o=s(e,n),c=t.operator.substring(1);return i(c,o,t.expression)}for(var a=0;a<n.length;a++){var f=n[a].trim(),o=r.getPropertyValue(e,f);if(u(o,t))return!0}return!1},u=function(r,e){for(var t=e.expression.split(","),n=0;n<t.length;n++){var u=t[n].trim();if(i(e.operator,r,u))return!0}return!1},i=function(r,e,t){switch(r){case"=":return c(e,t);case"!=":return!c(e,t);case"%":return o(e,t);case"!%":return!o(e,t);case">":return f(e,t);case"<":return l(e,t);case"===":return a(e,t);default:return!1}},o=function(r,e){return r||"boolean"==typeof r?String(r).toLowerCase().indexOf(e.toLowerCase())>-1:!1},c=function(r,e){return r?r===e:!1},a=function(r,e){return r||(r=!1),"boolean"==typeof r?(e="true"===e,r===e):!1},f=function(r,e){var t=v(r);return t>e},l=function(r,e){var t=v(r);return e>t},s=function(e,t){var n=t.reduce(function(t,n){var u=r.getPropertyValue(e,n.trim()),i=v(u);return t*i},1);return n},v=function(r){if(r){if(!isNaN(r))return r;for(var e=r.split(" "),t=0;t<e.length;t++){var n=e[t];if(!isNaN(n))return n}}return 0},d={calculatePercentageMatch:function(r,t,n){var u=[];switch(n.toLowerCase()){case"availability":u=r.availability;break;case"master":u=r.master;break;default:u=r.attributes}var i=e(u,t);return i.length/u.length},include:function(r,t){return e(r,t)},exclude:function(r,t){return e(r,t,!0)},match:t};return d}]).service("PKMasterProductFilterService",["PKProductFilterService","PKCommonService","ArrayService",function(r,e,t){var n=function(t,n,u){for(var i=e.convertToCamelCase(u),o=0;o<n.length;o++){var c=n[o],a=e.castTrueType(c.name);if("master"===c.target.toLowerCase()&&r.match(t,c.filters)||t[i]===a)return!0}return!1},u=function(r,e,u,i){if(!u||!u.length)return i?r:[];var o=[];return r.forEach(function(r){var c=n(r,u,e);(i&&!c||!i&&c)&&t.insertIfNotExist(o,r)}),o},i={include:function(r,e,t){return u(r,e,t)},exclude:function(r,e,t){return u(r,e,t,!0)},exactMatch:n};return i}]).filter("include",["PKProductFilterService",function(r){return function(e,t){return r.include(e,t)}}]).filter("exclude",["PKProductFilterService",function(r){return function(e,t){return r.exclude(e,t)}}]).filter("statesInclude",["$filter","PKCommonService",function(r,e){return function(t,n){var u=e.flattenFilters(n);return r("include")(t,u)}}]).filter("statesExclude",["$filter","PKCommonService",function(r,e){return function(t,n){var u=e.flattenFilters(n);return r("exclude")(t,u)}}]).filter("masterInclude",["PKMasterProductFilterService",function(r){return function(e,t,n){return r.include(e,t,n)}}]).filter("masterExclude",["PKMasterProductFilterService",function(r){return function(e,t,n){return r.exclude(e,t,n)}}])}(),function(){"use strict";angular.module("pkFilters")}();